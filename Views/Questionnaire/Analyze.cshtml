@model IEnumerable<CPSC571Project6.Models.ChartDataClass>

@{
    ViewData["Title"] ="Analysis of " + @ViewBag.title;
}

<div>
    <a asp-controller="Questionnaire" asp-action="Index" asp-route-id="@ViewBag.topic_id">Back to Questionnaires</a>
</div>

<h1>@ViewBag.title</h1>
<p align="center">
        
    <u>@ViewBag.taken_Count users have taken this Questionnaire</u>

</p>

<html>
<body>


    @for (int i = 0; i < Model.Count(); i++)
    {
        <div>
            @(i+1).) @Html.DisplayFor(modelItem => Model.ToList()[i].question)
            <div id=@i style="width: 900px; height: 500px"></div>
        </div>

    }


</body>



<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var chartData = @Html.Raw(Json.Serialize(Model));

            for (i = 0; i < chartData.length; i++) {
                var data = google.visualization.arrayToDataTable([
                    ['Answer', 'Count'],
                    ['Poor (1)', chartData[i].value_1_count],
                    ['Not well (2)', chartData[i].value_2_count],
                    ['Moderate (3)', chartData[i].value_3_count],
                    ['Well (4)', chartData[i].value_4_count],
                    ['Excellent (5)', chartData[i].value_5_count]
                ]);

                var options = {
                    title: '',
                    cruveType: 'function',
                    legend: { position: 'bottom' }
                }

                var chart = new google.visualization.PieChart(document.getElementById(i));
                chart.draw(data, options);
            }



        }
</script>

</html>
